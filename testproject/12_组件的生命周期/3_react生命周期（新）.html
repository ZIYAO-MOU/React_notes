<!--
 * @Author: your name
 * @Date: 2021-02-02 21:51:30
 * @LastEditTime: 2021-02-03 02:44:54
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /react-app/testproject/12_组件的生命周期/3_react生命周期（新）.html
-->
<body>
    <div id="test"></div>
    <script type="text/javascript" src="../js/17.0.1/react.development.js"></script>
    <script type="text/javascript" src="../js/17.0.1/react-dom.development.js"></script>
    <script type="text/javascript" src="../js/17.0.1/babel.min.js"></script>
    <script type="text/babel">
    /*
        三个will生命周期被改写：
        componentWillUpdate
        componentWillMount
        componentWillReceiveProps
        这个三个生命周期方法常常被误解或者滥用，在异步渲染中这些钩子函数的误用问题会更大
        因此在17中三个钩子函数出现了UNSAFE_前缀
    */
    class Count extends  React.Component{
        //加1按钮的回调
        add=()=>{
            const {count}=this.state
            this.setState(
                {
                    count:count+1
                }
            )
        }
        //组件卸载
        death=()=>{
            ReactDOM.unmountComponentAtNode(document.getElementById('test'))
        }
        //强制更新
        force=()=>{
        this.forceUpdate()
        }
        //构造器
        constructor(props){
            console.log('count---constructor')
            super(props)
            this.state={count:0}
        }
        //刚出生
        static getDerivedStateFromProps(props,state){
            //state的值在任何时候都取决与props
            //横跨挂载和更新
            console.log('count---getDerivedStateFromProps',props,state)
            return null
        }
        //刚出生
        componentDidMount(){
            console.log('count---componentDidMount')
        }  
        //更改状态
        componentWillUnmount=()=>{
            console.log('count---componentWillUnmount')
        }
        //控制组件状态改变,每次想要更新组件的时候调用
        shouldComponentUpdate=()=>{
            console.log('count---shouldComponentUpdate')
            return false
        }
        //获取更新前的快照
        getSnapshotBeforeUpdate(){
            console.log('count---getSnapshotBeforeUpdate')
            return 'atguigu'
        }
        //组件将要更新钩子
        componentWillUpdate=()=>{
            console.log('count---componentWillUpdate')
        }
        //组建更新完毕钩子
        componentDidUpdate=(preProps,preState,snapshotValue)=>{
            console.log('count---componentDidUpdate',preProps,preState,snapshotValue)
    
        }
        render(){
            console.log('count---render')
            return(
                <div>
                    <h2>当前求和为：{this.state.count}</h2>
                    <button onClick={this.add}>点我+1</button>
                    <button onClick={this.death}>卸载组件</button>
                    <button onClick={this.force}>不更改任何状态中的数据，强制更新一下</button>
                </div>
            )
        }
    }
    ReactDOM.render(<Count count={0}/>,document.getElementById('test'))
    </script>
</body>
</html>